version: 2

models:
  - name: dim_listings_cleansed
    description: Cleansed table which contains airbnb listings. minimum nights corrects and price parses from string
    columns:

      - name: listing_id
        description: Listing ID from raw file
        tests:
          - unique #generic test built in #1
          - not_null #generic test built in #2

      - name: listing_name
        description: Listing name from raw file
        tests:
          - not_null
          - unique

      - name: host_id
        description: Host id from cleansed hosts
        tests:
          - not_null
          - relationship: #generic test built in #4
              to: ref('dim_hosts_cleansed')
              field: host_id

      - name: room_type
        description: Type of property, should fall in set categories
        tests:
          - not_null
          - accepted_values: #generic test built in #3
              name: unexpected_room_type # We can name our tests to make it easier to give more meaningful errors
              values:
                ['Entire home/apt',
                'Private room',
                'Shared room',
                'Hotel room']

      - name: minimum_nights
        description: Minimum nights to book
        tests:
          - positive_value

      #this code does not work. it should result in warning, but it doesnt.
      - name: created_at
        description: Created at, from the raw file
        tests:
          - dbt_utils.accepted_range:
              min_value: 'TO_TIMESTAMP(2025-01-01)'



